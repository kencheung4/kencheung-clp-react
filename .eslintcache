[{"/Users/cheungchingai/kencheung-clp-frontend/src/reportWebVitals.ts":"1","/Users/cheungchingai/kencheung-clp-frontend/src/index.tsx":"2","/Users/cheungchingai/kencheung-clp-frontend/src/App.tsx":"3","/Users/cheungchingai/kencheung-clp-frontend/src/Client.tsx":"4","/Users/cheungchingai/kencheung-clp-frontend/src/aws-exports.js":"5","/Users/cheungchingai/kencheung-clp-frontend/src/graphql/mutation.js":"6","/Users/cheungchingai/kencheung-clp-frontend/src/graphql/query.js":"7","/Users/cheungchingai/kencheung-clp-frontend/src/Dashboard.tsx":"8","/Users/cheungchingai/kencheung-clp-frontend/src/graphql/subscription.js":"9"},{"size":425,"mtime":1606404727159,"results":"10","hashOfConfig":"11"},{"size":1303,"mtime":1606587059745,"results":"12","hashOfConfig":"13"},{"size":470,"mtime":1606571275110,"results":"14","hashOfConfig":"13"},{"size":1972,"mtime":1606641341248,"results":"15","hashOfConfig":"13"},{"size":409,"mtime":1606465046729,"results":"16","hashOfConfig":"13"},{"size":564,"mtime":1606586685743,"results":"17","hashOfConfig":"13"},{"size":215,"mtime":1606564241000,"results":"18","hashOfConfig":"13"},{"size":5867,"mtime":1606641386000,"results":"19","hashOfConfig":"13"},{"size":279,"mtime":1606571636000,"results":"20","hashOfConfig":"13"},{"filePath":"21","messages":"22","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"23"},"2272qn",{"filePath":"24","messages":"25","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},"1fvl00e",{"filePath":"26","messages":"27","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"28"},{"filePath":"29","messages":"30","errorCount":0,"warningCount":9,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"31","messages":"32","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"33"},{"filePath":"34","messages":"35","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"36"},{"filePath":"37","messages":"38","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"39"},{"filePath":"40","messages":"41","errorCount":1,"warningCount":25,"fixableErrorCount":1,"fixableWarningCount":0,"source":"42"},{"filePath":"43","messages":"44","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"45"},"/Users/cheungchingai/kencheung-clp-frontend/src/reportWebVitals.ts",[],["46","47","48","49","50","51","52","53"],"/Users/cheungchingai/kencheung-clp-frontend/src/index.tsx",[],"/Users/cheungchingai/kencheung-clp-frontend/src/App.tsx",[],["54","55","56","57","58","59","60","61"],"/Users/cheungchingai/kencheung-clp-frontend/src/Client.tsx",["62","63","64","65","66","67","68","69","70"],"/Users/cheungchingai/kencheung-clp-frontend/src/aws-exports.js",[],["71","72","73","74","75","76","77","78"],"/Users/cheungchingai/kencheung-clp-frontend/src/graphql/mutation.js",["79"],"export const ClickBlue = `\n  mutation ClickBlue($id: ID!) {\n    clickBlue(id: $id) {\n      id\n      blue\n      red\n      black\n      clicks {\n        color\n        createdAt\n      }\n      createdAt\n    }\n  }\n`\n\nexport const ClickRed = `\n  mutation ClickRed($id: ID!) {\n    clickRed(id: $id) {  \n      id\n      blue\n      red\n      black\n      clicks {\n        color\n        createdAt\n      }\n      createdAt\n    }\n  }\n`\n\nexport const ResetGame = `\n  mutation ResetGame{\n    resetGame {\n      id\n    }\n  }\n`\n\nexport default {\n  ClickBlue,\n  ClickRed,\n  ResetGame,\n}","/Users/cheungchingai/kencheung-clp-frontend/src/graphql/query.js",["80"],"\nexport const GetGame = `\n  query getGame {\n    getGame {  \n      id\n      blue\n      red\n      black\n      clicks {\n        color\n        createdAt\n      }\n      createdAt\n    }\n  }\n`\n\nexport default {\n  GetGame,\n}","/Users/cheungchingai/kencheung-clp-frontend/src/Dashboard.tsx",["81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106"],"import React from 'react';\nimport gql from 'graphql-tag';\nimport { graphql, compose } from 'react-apollo';\nimport { graphqlMutation } from 'aws-appsync-react';\nimport { Line } from 'react-chartjs-2';\nimport moment from 'moment';\nimport _ from 'lodash';\n\nimport {\n  GetGame,\n} from './graphql/query';\n\nimport {\n  ResetGame,\n} from './graphql/mutation';\n\nimport {\n  updatedGameSubscription,\n} from './graphql/subscription';\n\ninterface Click {\n  createdAt: string\n  color: string\n}\n\ninterface Game {\n  blue: number;\n  red: number;\n  black: number;\n  clicks: [Click];\n  id: string;\n  createdAt: string;\n  isSubscribed: boolean;\n}\n\ninterface ChartDataState {\n  hasInit: boolean,\n  labels: Array<number>,\n  redData: Array<number>,\n  blueData: Array<number>,\n  blackData: Array<number>,\n}\n\ntype DashboardProps = {\n  game: Game,\n  subscribeToMoreClicks: Function,\n  resetGame: Function\n}\n\nconst Loading = () => {\n  return <div>Loading...</div>\n}\n\nlet chartUpdateInterval: NodeJS.Timeout;\nconst showMaxRecentSeconds = 30;\n\nfunction Dashboard(props: DashboardProps) {\n\n  const [chartData, setChartData] = React.useState<ChartDataState>({\n    hasInit: false,\n    labels: [],\n    redData: [],\n    blueData: [],\n    blackData: []\n  });\n\n  const { red, blue, black, clicks, createdAt, id } = props.game || {};\n\n  React.useEffect(() => {\n    const onBeforeUnload = () => {\n      console.log('before unload reset game');\n      props.resetGame();\n      return;\n    }\n    window.addEventListener('beforeunload', onBeforeUnload);\n    return () => {\n      window.removeEventListener('beforeunload', onBeforeUnload);\n    }\n  }, []);\n\n  React.useEffect(() => {\n    if (props.game?.id) {\n      console.log(\"start subscribeToMoreClicks\", props.game.id);\n      props.subscribeToMoreClicks(props.game.id);\n    }\n  }, [props.game]);\n\n  React.useEffect(() => {\n    if (!props.game?.id) return;\n\n    const updateChart = () => {\n      const minTime = moment(clicks[0]?.createdAt).unix();\n      const maxTime = moment(clicks[clicks.length - 1]?.createdAt).unix();\n\n      const intervals = maxTime - minTime + 1 > showMaxRecentSeconds ? showMaxRecentSeconds : maxTime - minTime + 1;\n\n      const labels = _.times(intervals, (n) => n + 1);\n      const initialData = _.times(intervals, () => 0);\n      const redData = [...initialData];\n      const blueData = [...initialData];\n      const blackData = [...initialData];\n\n      clicks.forEach(click => {\n        console.log(\"LOOPING each click\", click);\n        const currentTimeInterval = intervals - (maxTime - moment(click.createdAt).unix()) - 1;\n        if (currentTimeInterval < 0) {\n          // it's before showMaxRecentSeconds, skip show this click\n          return;\n        }\n        if (click.color === 'red') {\n          redData[currentTimeInterval] += 1;\n        } else if (click.color === 'blue') {\n          blueData[currentTimeInterval] += 1;\n        }\n        blackData[currentTimeInterval] = blueData[currentTimeInterval] - redData[currentTimeInterval];\n      })\n\n      setChartData({\n        hasInit: true,\n        labels,\n        redData,\n        blueData,\n        blackData\n      })\n    }\n\n    if (chartData.hasInit) {\n      clearInterval(chartUpdateInterval);\n      chartUpdateInterval = setInterval(updateChart, 5000);\n    } else {\n      updateChart();\n    }\n\n  }, [props.game]);\n\n  if (!id) {\n    return <Loading />\n  }\n\n  const data = {\n    labels: chartData.labels,\n    datasets: [\n      {\n        label: 'blue',\n        data: chartData.blueData,\n        fill: false,\n        backgroundColor: 'rgb(96, 165, 250)',\n        borderColor: 'rgba(96, 165, 250, 0.2)',\n      },\n      {\n        label: 'red',\n        data: chartData.redData,\n        fill: false,\n        backgroundColor: 'rgb(248, 113, 113)',\n        borderColor: 'rgba(248, 113, 113, 0.2)',\n      },\n      {\n        label: 'black',\n        data: chartData.blackData,\n        fill: false,\n        backgroundColor: 'rgb(0, 0, 0)',\n        borderColor: 'rgba(0, 0, 0, 0.2)',\n      },\n    ],\n  }\n\n  const options = {\n    scales: {\n      yAxes: [\n        {\n          ticks: {\n            beginAtZero: false,\n          },\n          scaleLabel: {\n            display: true,\n            labelString: 'Click(s)'\n          }\n        },\n      ],\n      xAxes: [\n        {\n          scaleLabel: {\n            display: true,\n            labelString: 'Seconds'\n          }\n        },\n      ],\n    },\n  }\n\n  return (\n    <div className=\"Dashboard p-8 flex justify-center\">\n      <div className='flex flex-col'>\n        <span>This chart show the recent {showMaxRecentSeconds} seconds clicks</span>\n        <Line data={data} options={options} width={480} height={240} />\n        <div className='flex flex-wrap justify-center p-8'>\n          <div className='flex items-center justify-center py-16 bg-blue-400 text-2xl text-white mx-8 w-60'>\n            {props.game.blue}\n          </div>\n          <div className='flex items-center justify-center py-16 bg-red-400 text-2xl text-white mx-8 w-60'>\n            {props.game.red}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default compose(\n  graphql(gql(GetGame), {\n    options: {\n      fetchPolicy: 'no-cache'\n    },\n    props: (props: any) => ({\n      game: props.data.getGame,\n      subscribeToMoreClicks: (id: string) => {\n        props.data.subscribeToMore({\n          document: gql(updatedGameSubscription),\n          variables: { id },\n          updateQuery: (prev: any, result: any) => {\n            console.log(\"subscribeToMoreClicks updateQuery\", result);\n            return {\n              getGame: {\n                ...result.subscriptionData.data.updatedGame,\n              },\n            }\n          }\n        })\n      },\n    })\n  }),\n  graphql(gql(ResetGame), {\n    options: {\n    },\n    props: (props: any) => ({\n      resetGame: () => {\n        props.mutate();\n      }\n    }),\n  }),\n)(Dashboard);\n","/Users/cheungchingai/kencheung-clp-frontend/src/graphql/subscription.js",["107"],"export const updatedGameSubscription = `\n  subscription updatedGame($id: ID!) {\n    updatedGame(id: $id) {\n      id\n      blue\n      red\n      black\n      clicks {\n        color\n        createdAt\n      }\n      createdAt\n    }\n  } \n`\n\nexport default {\n  updatedGameSubscription,\n}",{"ruleId":"108","replacedBy":"109"},{"ruleId":"110","replacedBy":"111"},{"ruleId":"112","replacedBy":"113"},{"ruleId":"114","replacedBy":"115"},{"ruleId":"116","replacedBy":"117"},{"ruleId":"118","replacedBy":"119"},{"ruleId":"120","replacedBy":"121"},{"ruleId":"122","replacedBy":"123"},{"ruleId":"108","replacedBy":"124"},{"ruleId":"110","replacedBy":"125"},{"ruleId":"112","replacedBy":"126"},{"ruleId":"114","replacedBy":"127"},{"ruleId":"116","replacedBy":"128"},{"ruleId":"118","replacedBy":"129"},{"ruleId":"120","replacedBy":"130"},{"ruleId":"122","replacedBy":"131"},{"ruleId":"132","severity":1,"message":"133","line":4,"column":10,"nodeType":"134","messageId":"135","endLine":4,"endColumn":25},{"ruleId":"136","severity":1,"message":"133","line":4,"column":10,"nodeType":"134","messageId":"135","endLine":4,"endColumn":25},{"ruleId":"137","severity":1,"message":"138","line":19,"column":11,"nodeType":"139","messageId":"140","endLine":19,"endColumn":14,"suggestions":"141"},{"ruleId":"137","severity":1,"message":"138","line":33,"column":16,"nodeType":"139","messageId":"140","endLine":33,"endColumn":19,"suggestions":"142"},{"ruleId":"143","severity":1,"message":"144","line":35,"column":9,"nodeType":"145","messageId":"146","endLine":35,"endColumn":21},{"ruleId":"143","severity":1,"message":"144","line":38,"column":7,"nodeType":"145","messageId":"146","endLine":38,"endColumn":18},{"ruleId":"137","severity":1,"message":"138","line":62,"column":20,"nodeType":"139","messageId":"140","endLine":62,"endColumn":23,"suggestions":"147"},{"ruleId":"137","severity":1,"message":"138","line":69,"column":20,"nodeType":"139","messageId":"140","endLine":69,"endColumn":23,"suggestions":"148"},{"ruleId":"137","severity":1,"message":"138","line":80,"column":20,"nodeType":"139","messageId":"140","endLine":80,"endColumn":23,"suggestions":"149"},{"ruleId":"108","replacedBy":"124"},{"ruleId":"110","replacedBy":"125"},{"ruleId":"112","replacedBy":"150"},{"ruleId":"114","replacedBy":"127"},{"ruleId":"116","replacedBy":"128"},{"ruleId":"118","replacedBy":"129"},{"ruleId":"120","replacedBy":"130"},{"ruleId":"122","replacedBy":"131"},{"ruleId":"151","severity":1,"message":"152","line":41,"column":1,"nodeType":"153","endLine":45,"endColumn":2},{"ruleId":"151","severity":1,"message":"152","line":18,"column":1,"nodeType":"153","endLine":20,"endColumn":2},{"ruleId":"132","severity":1,"message":"133","line":4,"column":10,"nodeType":"134","messageId":"135","endLine":4,"endColumn":25},{"ruleId":"136","severity":1,"message":"133","line":4,"column":10,"nodeType":"134","messageId":"135","endLine":4,"endColumn":25},{"ruleId":"132","severity":1,"message":"154","line":67,"column":11,"nodeType":"134","messageId":"135","endLine":67,"endColumn":14},{"ruleId":"136","severity":1,"message":"154","line":67,"column":11,"nodeType":"134","messageId":"135","endLine":67,"endColumn":14},{"ruleId":"132","severity":1,"message":"155","line":67,"column":16,"nodeType":"134","messageId":"135","endLine":67,"endColumn":20},{"ruleId":"136","severity":1,"message":"155","line":67,"column":16,"nodeType":"134","messageId":"135","endLine":67,"endColumn":20},{"ruleId":"132","severity":1,"message":"156","line":67,"column":22,"nodeType":"134","messageId":"135","endLine":67,"endColumn":27},{"ruleId":"136","severity":1,"message":"156","line":67,"column":22,"nodeType":"134","messageId":"135","endLine":67,"endColumn":27},{"ruleId":"132","severity":1,"message":"157","line":67,"column":37,"nodeType":"134","messageId":"135","endLine":67,"endColumn":46},{"ruleId":"136","severity":1,"message":"157","line":67,"column":37,"nodeType":"134","messageId":"135","endLine":67,"endColumn":46},{"ruleId":"143","severity":1,"message":"144","line":71,"column":7,"nodeType":"145","messageId":"146","endLine":71,"endColumn":18},{"ruleId":"158","severity":2,"message":"159","line":73,"column":7,"nodeType":"160","messageId":"161","endLine":73,"endColumn":14,"fix":"162"},{"ruleId":"163","severity":1,"message":"164","line":79,"column":6,"nodeType":"165","endLine":79,"endColumn":8,"suggestions":"166"},{"ruleId":"143","severity":1,"message":"144","line":83,"column":7,"nodeType":"145","messageId":"146","endLine":83,"endColumn":18},{"ruleId":"163","severity":1,"message":"164","line":86,"column":6,"nodeType":"165","endLine":86,"endColumn":18,"suggestions":"167"},{"ruleId":"168","severity":1,"message":"169","line":95,"column":1,"nodeType":"170","messageId":"171","endLine":95,"endColumn":117},{"ruleId":"143","severity":1,"message":"144","line":104,"column":9,"nodeType":"145","messageId":"146","endLine":104,"endColumn":20},{"ruleId":"168","severity":1,"message":"172","line":105,"column":1,"nodeType":"170","messageId":"171","endLine":105,"endColumn":96},{"ruleId":"168","severity":1,"message":"173","line":115,"column":1,"nodeType":"170","messageId":"171","endLine":115,"endColumn":103},{"ruleId":"163","severity":1,"message":"174","line":134,"column":6,"nodeType":"165","endLine":134,"endColumn":18,"suggestions":"175"},{"ruleId":"168","severity":1,"message":"176","line":194,"column":1,"nodeType":"170","messageId":"171","endLine":194,"endColumn":86},{"ruleId":"137","severity":1,"message":"138","line":214,"column":20,"nodeType":"139","messageId":"140","endLine":214,"endColumn":23,"suggestions":"177"},{"ruleId":"137","severity":1,"message":"138","line":220,"column":31,"nodeType":"139","messageId":"140","endLine":220,"endColumn":34,"suggestions":"178"},{"ruleId":"137","severity":1,"message":"138","line":220,"column":44,"nodeType":"139","messageId":"140","endLine":220,"endColumn":47,"suggestions":"179"},{"ruleId":"143","severity":1,"message":"144","line":221,"column":13,"nodeType":"145","messageId":"146","endLine":221,"endColumn":24},{"ruleId":"137","severity":1,"message":"138","line":235,"column":20,"nodeType":"139","messageId":"140","endLine":235,"endColumn":23,"suggestions":"180"},{"ruleId":"151","severity":1,"message":"152","line":17,"column":1,"nodeType":"153","endLine":19,"endColumn":2},"no-native-reassign",["181"],"no-negated-in-lhs",["182"],"jsx-a11y/accessible-emoji",[],"lines-around-directive",["183"],"global-require",[],"no-buffer-constructor",[],"no-new-require",[],"no-path-concat",[],["181"],["182"],[],["183"],[],[],[],[],"no-unused-vars","'graphqlMutation' is defined but never used.","Identifier","unusedVar","@typescript-eslint/no-unused-vars","@typescript-eslint/no-explicit-any","Unexpected any. Specify a different type.","TSAnyKeyword","unexpectedAny",["184","185"],["186","187"],"no-console","Unexpected console statement.","MemberExpression","unexpected",["188","189"],["190","191"],["192","193"],[],"import/no-anonymous-default-export","Assign object to a variable before exporting as module default","ExportDefaultDeclaration","'red' is assigned a value but never used.","'blue' is assigned a value but never used.","'black' is assigned a value but never used.","'createdAt' is assigned a value but never used.","no-useless-return","Unnecessary return statement.","ReturnStatement","unnecessaryReturn",{"range":"194","text":"195"},"react-hooks/exhaustive-deps","React Hook React.useEffect has a missing dependency: 'props'. Either include it or remove the dependency array. However, 'props' will change when *any* prop changes, so the preferred fix is to destructure the 'props' object outside of the useEffect call and refer to those specific props inside React.useEffect.","ArrayExpression",["196"],["197"],"max-len","This line has a length of 116. Maximum allowed is 80.","Program","max","This line has a length of 95. Maximum allowed is 80.","This line has a length of 102. Maximum allowed is 80.","React Hook React.useEffect has missing dependencies: 'chartData.hasInit' and 'clicks'. Either include them or remove the dependency array.",["198"],"This line has a length of 85. Maximum allowed is 80.",["199","200"],["201","202"],["203","204"],["205","206"],"no-global-assign","no-unsafe-negation","padding-line-between-statements",{"messageId":"207","fix":"208","desc":"209"},{"messageId":"210","fix":"211","desc":"212"},{"messageId":"207","fix":"213","desc":"209"},{"messageId":"210","fix":"214","desc":"212"},{"messageId":"207","fix":"215","desc":"209"},{"messageId":"210","fix":"216","desc":"212"},{"messageId":"207","fix":"217","desc":"209"},{"messageId":"210","fix":"218","desc":"212"},{"messageId":"207","fix":"219","desc":"209"},{"messageId":"210","fix":"220","desc":"212"},[1350,1449],"() => {\n      console.log('before unload reset game');\n      props.resetGame();\n      \n    }",{"desc":"221","fix":"222"},{"desc":"223","fix":"224"},{"desc":"225","fix":"226"},{"messageId":"207","fix":"227","desc":"209"},{"messageId":"210","fix":"228","desc":"212"},{"messageId":"207","fix":"229","desc":"209"},{"messageId":"210","fix":"230","desc":"212"},{"messageId":"207","fix":"231","desc":"209"},{"messageId":"210","fix":"232","desc":"212"},{"messageId":"207","fix":"233","desc":"209"},{"messageId":"210","fix":"234","desc":"212"},"suggestUnknown",{"range":"235","text":"236"},"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct.","suggestNever",{"range":"235","text":"237"},"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of.",{"range":"238","text":"236"},{"range":"238","text":"237"},{"range":"239","text":"236"},{"range":"239","text":"237"},{"range":"240","text":"236"},{"range":"240","text":"237"},{"range":"241","text":"236"},{"range":"241","text":"237"},"Update the dependencies array to be: [props]",{"range":"242","text":"243"},"Update the dependencies array to be: [props, props.game]",{"range":"244","text":"245"},"Update the dependencies array to be: [chartData.hasInit, clicks, props.game]",{"range":"246","text":"247"},{"range":"248","text":"236"},{"range":"248","text":"237"},{"range":"249","text":"236"},{"range":"249","text":"237"},{"range":"250","text":"236"},{"range":"250","text":"237"},{"range":"251","text":"236"},{"range":"251","text":"237"},[347,350],"unknown","never",[569,572],[1507,1510],[1631,1634],[1831,1834],[1607,1609],"[props]",[1791,1803],"[props, props.game]",[3301,3313],"[chartData.hasInit, clicks, props.game]",[5190,5193],[5426,5429],[5439,5442],[5771,5774]]